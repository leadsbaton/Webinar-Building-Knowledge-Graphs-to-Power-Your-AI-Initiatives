<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Building Knowledge Graphs to Power Your AI Initiatives</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <!-- EmailJS v4 -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

    <style>
        :root {
            --brand: #e11d2e;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        }

        .shadow-card {
            box-shadow: 0 10px 25px rgba(0, 0, 0, .06);
        }
    </style>
</head>

<body class="bg-gray-100 text-gray-800">

    <!-- Navbar (you already have this file) -->
    <div id="navbar"></div>

    <!-- Main -->
    <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 mt-8 mb-16">
        <section class="bg-white rounded-2xl shadow-card p-6 sm:p-10">
            <h1 class="text-2xl font-semibold mb-4">
                Building Knowledge Graphs to Power Your AI Initiatives
            </h1>
            <p class="mt-2 text-sm sm:text-base text-gray-600">
                <strong>Thank you for your interest in DBTA Downloads/Webinars!</strong>
            </p>

            <form id="contactForm" class="mt-8 grid grid-cols-1 gap-5 max-w-xl">
                <!-- Identify this as Form 1 -->
                <input type="hidden" name="form_name"
                    value="Building Knowledge Graphs to Power Your AI Initiatives" />

                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700">Name</label>
                    <input id="name" name="name" type="text" autocomplete="name" required
                        class="mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-200 focus:border-red-400" />
                    <p data-err="name" class="hidden mt-1 text-sm text-red-600"></p>
                </div>

                <div>
                    <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                    <input id="email" name="email" type="email" autocomplete="email" required
                        class="mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-200 focus:border-red-400" />
                    <p data-err="email" class="hidden mt-1 text-sm text-red-600"></p>
                </div>

                <div>
                    <label for="job_title" class="block text-sm font-medium text-gray-700">Job Title</label>
                    <input id="job_title" name="job_title" type="text" required
                        class="mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-200 focus:border-red-400" />
                    <p data-err="job_title" class="hidden mt-1 text-sm text-red-600"></p>
                </div>

                <div>
                    <label for="company" class="block text-sm font-medium text-gray-700">Company</label>
                    <input id="company" name="company" type="text" required
                        class="mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-200 focus:border-red-400" />
                    <p data-err="company" class="hidden mt-1 text-sm text-red-600"></p>
                </div>

                <div>
                    <label for="country" class="block text-sm font-medium text-gray-700">Country</label>
                    <input id="country" name="country" type="text" required
                        class="mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-200 focus:border-red-400" />
                    <p data-err="country" class="hidden mt-1 text-sm text-red-600"></p>
                </div>

                <!-- Newsletter (required) -->
                <label class="flex items-center gap-3">
                    <input id="newsletter" name="newsletter" type="checkbox"
                        class="h-4 w-4 mt-0 flex-shrink-0 rounded border-gray-300 text-red-600 focus:ring-red-500"
                        required />
                    <span class="text-sm text-gray-700">Tick this box to receive our newsletter</span>
                </label>
                <p data-err="newsletter" class="hidden -mt-3 text-sm text-red-600"></p>

                <!-- Terms / Privacy (required) -->
                <label class="flex items-center gap-3">
                    <input id="terms" type="checkbox"
                        class="h-4 w-4 mt-0 flex-shrink-0 rounded border-gray-300 text-red-600 focus:ring-red-500"
                        required />
                    <span class="text-sm text-gray-700">
                        By requesting this resource, you agree to our terms of use. All data is protected by our Privacy
                        Notice.
                        If you have any further questions please email
                        <a href="mailto:info@leadsbaton.com" class="text-red-600 underline">info@leadsbaton.com</a>
                    </span>
                </label>

                <p data-err="terms" class="hidden -mt-3 text-sm text-red-600"></p>

                <button id="submitBtn" type="submit"
                    class="inline-flex items-center justify-center rounded-md bg-[var(--brand)] px-4 py-2 font-semibold text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition disabled:opacity-60 disabled:cursor-not-allowed">
                    <svg id="btnSpinner" class="hidden animate-spin -ml-1 mr-2 h-5 w-5" viewBox="0 0 24 24" fill="none">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
                        </circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
                    </svg>
                    <span id="btnText">SUBMIT</span>
                </button>
            </form>

            <!-- Success / Error toasts -->
            <div id="toast" class="fixed top-5 right-5 hidden z-50 px-5 py-3 rounded-lg shadow-lg text-white"></div>
        </section>
    </main>

    <!-- Footer (you already have this file) -->
    <div id="footer"></div>

    <script>
        /* ---------------------------------------------------------
           Config
        --------------------------------------------------------- */
        const EMAIL_PUBLIC_KEY = "I64IeI2zG_00GsyoX";
        const EMAIL_SERVICE_ID = "service_z09fuxl";
        const EMAIL_TEMPLATE_ID = "template_sgg6gwp";


        /* ---------------------------------------------------------
           Boot
        --------------------------------------------------------- */
        // Mount header/footer you already have
        fetch('navbar.html').then(r => r.text()).then(html => document.getElementById('navbar').innerHTML = html);
        fetch('footer.html').then(r => r.text()).then(html => document.getElementById('footer').innerHTML = html);

        // Init EmailJS
        emailjs.init({ publicKey: EMAIL_PUBLIC_KEY });

        /* ---------------------------------------------------------
           Helpers
        --------------------------------------------------------- */
        const $ = (sel, root = document) => root.querySelector(sel);
        const showToast = (msg, ok = true) => {
            const el = $('#toast');
            el.textContent = msg;
            el.className = "fixed top-5 right-5 z-50 px-5 py-3 rounded-lg shadow-lg text-white " + (ok ? "bg-green-600" : "bg-red-600");
            el.classList.remove('hidden');
            setTimeout(() => el.classList.add('hidden'), 2800);
        };

        const setLoading = (loading) => {
            $('#submitBtn').disabled = loading;
            $('#btnSpinner').classList.toggle('hidden', !loading);
            $('#btnText').textContent = loading ? 'SENDINGâ€¦' : 'SUBMIT';
        };

        const setErr = (name, msg = '') => {
            const el = document.querySelector(`[data-err="${name}"]`);
            if (!el) return;
            if (msg) { el.textContent = msg; el.classList.remove('hidden'); }
            else { el.textContent = ''; el.classList.add('hidden'); }
        };

        const validate = (form) => {
            let ok = true;

            const name = form.name.value.trim();
            const email = form.email.value.trim();
            const job = form.job_title.value.trim();
            const company = form.company.value.trim();
            const country = form.country.value.trim();
            const newsletter = form.newsletter.checked;
            const terms = $('#terms').checked;

            setErr('name'); setErr('email'); setErr('job_title'); setErr('company'); setErr('country'); setErr('newsletter'); setErr('terms');

            if (!name) { setErr('name', 'Name is required.'); ok = false; }
            if (!email) { setErr('email', 'Email is required.'); ok = false; }
            else if (!/^\S+@\S+\.\S+$/.test(email)) { setErr('email', 'Enter a valid email.'); ok = false; }
            if (!job) { setErr('job_title', 'Job title is required.'); ok = false; }
            if (!company) { setErr('company', 'Company is required.'); ok = false; }
            if (!country) { setErr('country', 'Country is required.'); ok = false; }
            if (!newsletter) { setErr('newsletter', 'Please tick to receive our newsletter.'); ok = false; }
            if (!terms) { setErr('terms', 'You must agree to the terms & privacy.'); ok = false; }

            return ok;
        };

        /* ---------------------------------------------------------
           Submit
        --------------------------------------------------------- */
        document.getElementById('contactForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const form = this;

            if (!validate(form)) {
                showToast("Please fix the highlighted fields.", false);
                return;
            }

            const payload = {
                form_name: form.form_name.value,
                name: form.name.value.trim(),
                email: form.email.value.trim(),
                job_title: form.job_title.value.trim(),
                company: form.company.value.trim(),
                country: form.country.value.trim(),
                newsletter: form.newsletter.checked ? "Yes" : "No",
                time: new Date().toLocaleString()
            };

            try {
                setLoading(true);
                await emailjs.send(EMAIL_SERVICE_ID, EMAIL_TEMPLATE_ID, payload);

                showToast("Successfully Registered!");

                //clear data
                form.reset();

            } catch (err) {
                console.error('EmailJS Error:', err);
                showToast("Failed to send. Please try again.", false);
            } finally {
                setLoading(false);
            }
        });
    </script>
</body>

</html>